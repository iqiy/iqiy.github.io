---
layout:     post
title:      "图像处理基础（二）"
subtitle:   "像机标定方法"
date:       2020-06-9 18:10:00
author:     "QIY"
header-img: "img/IAP.png"
header-mask: 0.3 
catalog:    true
tags:
    - image processing 
---

> 图像处理 的学习基本上是学十得一。稳扎稳打再来一次

* TOC

{:toc}

像机标定

# 1 背景

## 1.1 为什么要相机标定？<br />
确定空间物体表面某点的三维几何位置与其在图像中对应点之间的相互关系，必须建立相机成像的几何模型，这些几何模型参数就是相机参数。摄像机标定过程，简单的可以简单的描述为通过标定板，如下图，可以得到n个对应的世界坐标三维点Xi和对应的图像坐标二维点xi，这些三维点到二维点的转换都可以通过上面提到的相机内参K，相机外参R和t，以及畸变参数D，经过一系列的矩阵变换得到。<br />
## 1.2 什么叫相机标定？
在大多数条件下这些参数必须通过实验与计算才能得到，这个求解参数的过程就称之为相机标定（或摄像机标定）。
## 1.3 相机标定方法有哪些？
相机标定方法有：传统相机标定法、主动视觉相机标定方法、相机自标定法。
## 1.4 常用术语
内参矩阵: Intrinsic Matrix<br />
焦距: Focal Length<br />
主点: Principal Point<br />
径向畸变: Radial Distortion<br />
切向畸变: Tangential Distortion<br />
旋转矩阵: Rotation Matrices<br />
平移向量: Translation Vectors<br />
平均重投影误差: Mean Reprojection Error<br />
重投影误差: Reprojection Errors<br />
重投影点: Reprojected Points<br />
# 2 各坐标系
![](/img/in-post/200609_IAP_Cam_cali/4c570ee2f679076f4d16e05c3eca29fa.png)
## 2.1 世界坐标系
世界坐标系（world
coordinate），也称为测量坐标系，是一个三维直角坐标系，以其为基准可以描述相机和待测物体的空间位置。世界坐标系的位置可以根据实际情况自由确定。
## 2.2 相机坐标系
相机坐标系（camera
coordinate），也是一个三维直角坐标系，原点位于镜头光心处，x、y轴分别与相面的两边平行，z轴为镜头光轴，与像平面垂直。
## 2.3 相机坐标系转换为世界坐标系
转换方程为：
![](/img/in-post/200609_IAP_Cam_cali/37b38a90f2bf4455de177fef6bcba42d.png)
其中R为3\*3的旋转矩阵，t为3\*1的平移矢量，为相机坐标系的齐次坐标，为世界坐标系的齐次坐标。<br />
具体步骤为下图所示：<br />
![](/img/in-post/200609_IAP_Cam_cali/3453ba3e216763fe4796f6cdf659fa4b.png)
![](/img/in-post/200609_IAP_Cam_cali/182e178c7c500d26f405ae1011b9641e.png)
![](/img/in-post/200609_IAP_Cam_cali/ff72324ca8daf1c56278f75804a41a7f.png)
## 2.4 像素坐标系、图像坐标系
![](/img/in-post/200609_IAP_Cam_cali/cbd125eafac26f5fffcbe58cc6d7caea.png)
像素坐标系（pixel coordinate）
上图，像素坐标系是一个二维直角坐标系，反映了相机CCD/CMOS芯片中像素的排列情况。原点位于图像的左上角，轴、轴分别于像面的两边平行。像素坐标系中坐标轴的单位是像素（整数）。
像素坐标系不利于坐标变换，因此需要建立图像坐标系，其坐标轴的单位通常为毫米（mm），原点是相机光轴与相面的交点（称为主点），即图像的中心点，轴、轴分别与轴、轴平行。故两个坐标系实际是平移关系，即可以通过平移就可得到。
## 2.5 像素坐标系转换为图像坐标系
![](/img/in-post/200609_IAP_Cam_cali/3ff8704893d2239ee8907f8735ca817f.png)
其中u、v分别为像素在、轴方向上的物理尺寸，为主点（图像原点）坐标。（这里 =dx）。
## 2.6 相机坐标系转换为图像坐标系
![](/img/in-post/200609_IAP_Cam_cali/6663812c314bb7f49a6d658f403b06aa.png)
针孔成像原理，如图中，空间任意一点与其图像点之间的关系，p与相机光心
的连线为op，与像面的交点即为空间点在图像平面上的投影。
该过程为透视投影，由上图的矩阵表示。
其中，Zc为比例因子（Zc不为0），为有效焦距（光心到图像平面的距离），是空间点在相机坐标系中的齐次坐标，是像点在图像坐标系中的齐次坐标。
## 2.7 世界坐标系转换为像素坐标系
![](/img/in-post/200609_IAP_Cam_cali/0c66c7129415f7a80f607b05356a3254.png)
上面的式子也等于：MXw ，其中M成为投影矩阵，是相机内参矩阵和相机外参矩阵的乘积。
其中 f 为摄像机的焦距，单位一般是mm;dx,dy 为像元尺寸;u0,v0 为图像中心。fx =
f/dx, fy = f/dy,分别称为x轴和y轴上的归一化焦距。

# 3 举例
现以NiKon D700相机为例进行求解其内参数矩阵：
就算大家身边没有这款相机也无所谓，可以在网上百度一下，很方便的就知道其一些参数：
焦距 f = 35mm 最高分辨率：4256×2832 传感器尺寸：36.0×23.9 mm
根据以上定义可以有：<br />
u0= 4256/2 = 2128 v0= 2832/2 = 1416 dx = 36.0/4256 dy = 23.9/2832 <br />
fx = f/dx = 4137.8 fy = f/dy = 4147.3

其中相机的内参和外参可以通过张正友标定获取。通过最终的转换关系来看，一个三维中的坐标点，的确可以在图像中找到一个对应的像素点（为什么？你自己想想矩阵的运算，你就可以知道了），但是反过来，通过图像中的一个点找到它在三维中对应的点就很成了一个问题，因为我们并不知道等式左边的Zc的值。<br />
参考：<https://blog.csdn.net/baidu_38172402/article/details/81949447>
